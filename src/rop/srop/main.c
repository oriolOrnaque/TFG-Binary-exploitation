#include <stdio.h>
#include <unistd.h>

volatile const char* binsh = "/bin/sh";

void gadgets(void)
{
#ifdef __LP64__ /* 64 bit */
    __asm__("pop %rax; ret;");
    __asm__("syscall; ret;");
#else /* 32 bit */
    __asm__("pop %eax; ret;");
    __asm__("int $0x80; ret;");
#endif /* __LP64__ */
}

void vuln(void)
{
    char buffer[64];

    read(STDIN_FILENO, buffer, 500);
}

/* gcc -ggdb -fno-stack-protector -no-pie (-m32) main.c */
/* ASLR disabled on the host */
int main()
{
    vuln();

    return 0;
}
