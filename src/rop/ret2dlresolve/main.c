#include <stdio.h>
#include <unistd.h>

void gadget(void)
{
#ifdef __LP64__
    __asm__("pop %rdi; pop %rsi; pop %rdx; ret");
    __asm__("pop %rax; syscall; ret");
#endif /* __LP64__ */
}

void vuln(void)
{
    char buffer[64];

    read(STDIN_FILENO, buffer, 184);
}

/* gcc -fno-stack-protector -no-pie -ggdb -Wl,-z,norelro (-m32) main.c */
/* ASLR disabled on the host */
int main()
{
    vuln();

    return 0;
}
