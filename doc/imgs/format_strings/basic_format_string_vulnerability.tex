\documentclass[../tfg.tex]{subfiles}

\begin{document}

\begin{lstlisting}[escapechar = @]
int main(int argc, char* argv[]){
    if(argc != 2) return 1;

    printf(argv[1]);@\tikz[remember picture] \node (fmt_str_vuln) {};@

    return 0;
}
\end{lstlisting}

\begin{tikzpicture}[remember picture, overlay]
\node (vuln) [right=2cm of fmt_str_vuln, fill=red!20] {Format string vulnerability};
\draw [-{Latex[round]}] (vuln.west) -- (fmt_str_vuln.east);
\end{tikzpicture}

\end{document}
