\documentclass[../tfg.tex]{subfiles}

\begin{document}

\begin{lstlisting}[escapechar = @, caption={\texttt{sudoers.c:set\_cmnd}}]
if (sudo_mode & (MODE_RUN | MODE_EDIT | MODE_CHECK)) {
    /* ... */
    if (ISSET(sudo_mode, MODE_SHELL|MODE_LOGIN_SHELL)) {
        for (to = user_args, av = NewArgv + 1; (from = *av); av++) {
	    while (*from) {
		if (from[0]@\tikz[remember picture] \node (from0) {};@ == '\\' && !isspace((unsigned char)from[1]@\tikz[remember picture] \node (from1) {};@))
	            from++;
		*to++ = *from++;
	    }
	    *to++ = ' ';
	}
        /* ... */@\tikz[remember picture] \node (arg) {};@
    }
    /* ... */
}
\end{lstlisting}

\begin{tikzpicture}[remember picture, overlay]

\node (arg1) [fill=cyan!20, right=2cm of arg.east, minimum height=0.7cm] {AAAAAAAA};
\node (arg2) [fill=red!20, right=0cm of arg1.east, minimum height=0.7cm] {\char`\\};
\node (arg3) [fill=cyan!20, right=0cm of arg2.east, minimum height=0.7cm] {0x0};
\node (arg4) [fill=cyan!20, right=0cm of arg3.east, minimum height=0.7cm] {more data};

\draw[-{Latex[round]}] (from0.south) -| (arg2.north);
\draw[-{Latex[round]}] (from1.south) -| (arg3.north);

\end{tikzpicture}

\end{document}

