\documentclass[../tfg.tex]{subfiles}

\begin{document}

\begin{lstlisting}[escapechar = !]
0000000000401040 <puts@plt>:
  401040:       f3 0f 1e fa             endbr64 
  401044:       f2 ff 25 cd 2f 00 00    bnd jmp!\tikz[remember picture] \node (jmpgot) {};!QWORD PTR [rip+0x2fcd]        # 404018 <puts@GLIBC_2.2.5>
  40104b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]
\end{lstlisting}

\begin{lstlisting}[escapechar = !]
Disassembly of section .got.plt:

0000000000404000 <_GLOBAL_OFFSET_TABLE_>:
  404000:       20 3e                   and    BYTE PTR [rsi],bh
  404002:       40 00 00                add    BYTE PTR [rax],al
      !\tikz[remember picture] \node (dlresolve) {};!...
  404015:       00 00                   add    BYTE PTR [rax],al
  404017:       00!\tikz[remember picture] \node (preparedefault0) {};!30                   add    BYTE PTR [rax],dh
  404019:       10 40!\tikz[remember picture] \node (preparedefault1) {};!00                adc    BYTE PTR [rax+0x0],al
  40401c:       00 00                   add    BYTE PTR [rax],al
        ...
\end{lstlisting}

\begin{lstlisting}[escapechar = !]
Disassembly of section .plt:

0000000000401020 <.plt>:
  !\tikz[remember picture] \node (jmppltdefault2) {};!401020:       ff 35 e2 2f 00 00       push   QWORD PTR [rip+0x2fe2]        # 404008 <_GLOBAL_OFFSET_TABLE_+0x8>
  401026:       f2 ff 25 e3 2f 00 00    bnd jmp!\tikz[remember picture] \node (jmppltdefault3) {};! QWORD PTR [rip+0x2fe3]        # 404010 <_GLOBAL_OFFSET_TABLE_+0x10>
  40102d:       0f 1f 00                nop    DWORD PTR [rax]
  401030:       f3 0f 1e fa             !\tikz[remember picture] \node (jmppltdefault0) {};!endbr64 
  401034:       68 00 00 00 00          push   0x0
  401039:       f2 e9 e1 ff ff ff       bnd jmp!\tikz[remember picture] \node (jmppltdefault1) {};! 401020 <.plt>
  40103f:       90                      nop
\end{lstlisting}

\begin{tikzpicture}[remember picture, overlay]

    \path[bend left, -{Latex[round]}] (jmpgot.south) edge node [auto, fill=cyan!40] {1} (preparedefault0.north);
    \path[bend right, -{Latex[round]}] (preparedefault1.south) edge node [auto, fill=cyan!40] {2} (jmppltdefault0.north);
    \path[bend left, -{Latex[round]}] (jmppltdefault1.north) edge node [auto, fill=cyan!40] {3} (jmppltdefault2.south);
    \path[bend right, -{Latex[round]}] (jmppltdefault3.north) edge node [auto, fill=cyan!40] {4} (dlresolve.south);

\end{tikzpicture}

\end{document}

